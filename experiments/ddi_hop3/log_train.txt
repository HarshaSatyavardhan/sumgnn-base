============ Initialized logger ============
add_feat_emb: True	 add_ht_emb: True	 add_sb_emb: True	 add_transe_emb: True	 add_traspose_rels: False	 attn_rel_emb_dim: 32	 batch_size: 256	 clip: 1000	 constrained_neg_prob: 0.0	 dataset: drugbank	 disable_cuda: False	 dropout: 0.3	 early_stop: 100	 edge_dropout: 0.4	 emb_dim: 32	 enclosing_sub_graph: True	 eval_every: 3	 eval_every_iter: 526	 exp_dir: utils/../experiments/ddi_hop3	 experiment_name: ddi_hop3	 feat: morgan	 feat_dim: 1024	 gamma: 0.2	 gnn_agg_type: sum	 gpu: 2	 has_attn: True	 has_kg: True	 hop: 3	 kge_model: TransE	 l2: 1e-05	 load_model: False	 lr: 0.005	 main_dir: utils/..	 max_links: 250000	 max_nodes_per_hop: 200	 model_type: dgl	 num_bases: 10	 num_epochs: 50	 num_gcn_layers: 2	 num_neg_samples_per_link: 0	 num_workers: 10	 optimizer: Adam	 rel_emb_dim: 32	 save_every: 10	 test_file: test	 train_file: train	 use_kge_embeddings: False	 valid_file: dev
============================================
Sampling negative links for train
Sampling negative links for valid
Sampling negative links for test
Extracting enclosing subgraphs for positive links in train set
Extracting enclosing subgraphs for negative links in train set
Extracting enclosing subgraphs for positive links in valid set
Extracting enclosing subgraphs for negative links in valid set
Extracting enclosing subgraphs for positive links in test set
Extracting enclosing subgraphs for negative links in test set
Max distance from sub : 3, Max distance from obj : 3
Max distance from sub : 3, Max distance from obj : 3
Max distance from sub : 3, Max distance from obj : 3
Device: cpu
Input dim : 8, # Relations : 86, # Augmented relations : 109
No existing model found. Initializing new model..
Total number of parameters: 1217850
Starting training with full batch...
[95m Eval Performance:{'auc': 0.6753969581601351, 'microf1': 0.87312734082397, 'k': 0.8491874766965491}in 154.6118791103363[0m
[93m Test Performance:{'auc': 0.6576974250977181, 'microf1': 0.8749316744319217, 'k': 0.8511850758869006}in 154.61272740364075[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.        , 0.79661017, 0.97536946, 0.75453575, 0.85714286,
       0.88639761, 0.        , 0.72727273, 0.8718593 , 0.90839695,
       0.51923077, 0.725     , 0.82352941, 0.87407407, 0.85714286,
       0.95052202, 0.875     , 0.60869565, 0.48275862, 0.86885246,
       0.8974359 , 0.94117647, 0.42857143, 0.98630137, 0.84363636,
       0.        , 0.9673913 , 0.        , 0.93939394, 0.66956522,
       0.        , 0.96437055, 0.51908397, 0.85470085, 0.66666667,
       0.5       , 0.88907015, 0.5       , 1.        , 0.96721311,
       0.        , 0.        , 0.        , 0.        , 1.        ,
       0.90909091, 0.88146491, 0.47058824, 0.92089166, 0.71428571,
       1.        , 0.        , 0.69158879, 0.76433121, 0.95454545,
       0.33333333, 0.73454545, 0.90951276, 0.84210526, 0.86458632,
       0.92380952, 0.        , 0.        , 0.7090301 , 0.5       ,
       0.86363636, 0.90617849, 0.55421687, 0.86178862, 0.84918794,
       0.87912088, 0.92045455, 0.82688391, 0.98203593, 0.79367508,
       0.87719298, 0.79166667, 0.90909091, 0.        , 0.15384615,
       0.625     , 0.44210526, 0.95137421, 0.26666667, 0.75384615,
       0.33333333])}in 154.76487374305725[0m
Epoch 1 with loss: 0.816768661737442, training auc: 0.4399960953243945, training auc_pr: 0.7722684769126789, best validation AUC: 0.6753969581601351, weight_norm: 209.6744842529297 in 1286.0277998447418
[95m Eval Performance:{'auc': 0.7634315932260852, 'microf1': 0.8927382438618394, 'k': 0.8725909140563536}in 156.38710498809814[0m
[93m Test Performance:{'auc': 0.7528037674528009, 'microf1': 0.8939847471303262, 'k': 0.8739973986341963}in 156.3878469467163[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.66666667, 0.82352941, 0.99512195, 0.81247048, 0.90265487,
       0.91968504, 1.        , 0.75675676, 0.91293532, 0.90697674,
       0.43478261, 0.81481481, 0.88888889, 0.92517007, 0.89156627,
       0.96854764, 0.76923077, 0.56      , 0.55172414, 0.90368609,
       0.92592593, 0.97142857, 0.76190476, 0.98630137, 0.90070922,
       0.        , 0.95466667, 0.        , 0.95384615, 0.73417722,
       0.66666667, 0.97810219, 0.54666667, 0.95      , 0.25      ,
       0.43478261, 0.90196078, 0.8       , 1.        , 0.97560976,
       0.        , 0.        , 0.66666667, 0.        , 1.        ,
       0.90909091, 0.89319974, 0.76190476, 0.93474151, 0.33333333,
       0.96969697, 0.66666667, 0.75213675, 0.81132075, 0.91666667,
       0.5       , 0.83003953, 0.93488372, 1.        , 0.89125926,
       0.96907216, 0.        , 0.        , 0.78419453, 1.        ,
       0.97959184, 0.93087558, 0.53846154, 0.9137931 , 0.87666775,
       0.90769231, 0.95628415, 0.83575184, 0.97109827, 0.80811404,
       0.9537037 , 0.82125604, 1.        , 0.33333333, 0.15384615,
       0.85      , 0.69230769, 0.97540984, 0.96296296, 0.85714286,
       0.8       ])}in 156.51880979537964[0m
Epoch 2 with loss: 0.38059801496210555, training auc: 0.7024102262294891, training auc_pr: 0.8774518905831061, best validation AUC: 0.7634315932260852, weight_norm: 233.74290466308594 in 1298.9695556163788
[95m Eval Performance:{'auc': 0.800233226438288, 'microf1': 0.8972638368705784, 'k': 0.8779219180904732}in 158.42563033103943[0m
[93m Test Performance:{'auc': 0.7779291197611932, 'microf1': 0.8984096410630157, 'k': 0.8792767480261627}in 158.42627120018005[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.66666667, 0.93846154, 0.98039216, 0.83062201, 0.90909091,
       0.92258065, 1.        , 0.70588235, 0.93270366, 0.92607004,
       0.53571429, 0.9       , 1.        , 0.93793103, 0.85393258,
       0.97002725, 0.9375    , 0.82758621, 0.51612903, 0.90109003,
       0.91566265, 0.94736842, 0.8       , 1.        , 0.90974729,
       0.        , 0.94960212, 0.        , 0.97674419, 0.8015873 ,
       0.        , 0.97487437, 0.64968153, 0.91935484, 0.70588235,
       0.84848485, 0.91566265, 0.8       , 1.        , 0.99173554,
       0.        , 0.        , 0.        , 0.        , 0.90909091,
       0.90909091, 0.89069287, 0.86956522, 0.93786145, 0.57142857,
       1.        , 1.        , 0.76666667, 0.85880077, 0.83636364,
       0.25      , 0.85283019, 0.92343387, 0.85714286, 0.8909866 ,
       0.93617021, 0.        , 0.72727273, 0.78095238, 0.92307692,
       0.96153846, 0.94618834, 0.76      , 0.91743119, 0.88167814,
       0.91176471, 0.95555556, 0.83858603, 0.98224852, 0.82556591,
       0.9375    , 0.80612245, 1.        , 0.75      , 0.4       ,
       0.78947368, 0.67226891, 0.97520661, 0.96296296, 0.91034483,
       0.72727273])}in 158.55412030220032[0m
Epoch 3 with loss: 0.3282245318378721, training auc: 0.7685337505024827, training auc_pr: 0.893204893011787, best validation AUC: 0.800233226438288, weight_norm: 248.09495544433594 in 1305.5273325443268
[95m Eval Performance:{'auc': 0.8323163368263273, 'microf1': 0.9013212650853101, 'k': 0.8829323812979095}in 157.71162819862366[0m
[93m Test Performance:{'auc': 0.8044898435717401, 'microf1': 0.9030167365105807, 'k': 0.884853470671674}in 157.71234774589539[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.        , 0.94573643, 0.98019802, 0.83468318, 0.90434783,
       0.92957746, 1.        , 0.74      , 0.91186839, 0.90441176,
       0.59813084, 0.89583333, 0.875     , 0.92086331, 0.9047619 ,
       0.97653014, 0.9375    , 0.76923077, 0.64864865, 0.90273918,
       0.9202454 , 0.97142857, 0.83333333, 1.        , 0.87898089,
       0.        , 0.96398892, 0.        , 0.984375  , 0.81777778,
       1.        , 0.97073171, 0.62962963, 0.93442623, 0.73333333,
       0.56      , 0.92886345, 0.90909091, 1.        , 0.96721311,
       0.        , 0.        , 1.        , 0.8       , 1.        ,
       0.88888889, 0.89334862, 0.7       , 0.94110389, 1.        ,
       1.        , 0.        , 0.8372093 , 0.88306452, 0.88372093,
       0.22222222, 0.85211268, 0.94089835, 1.        , 0.89023651,
       0.97029703, 0.66666667, 0.8       , 0.79113924, 0.83333333,
       0.97959184, 0.94545455, 0.75247525, 0.95652174, 0.88745981,
       0.8962963 , 0.95277778, 0.84672619, 0.98795181, 0.83962264,
       0.98165138, 0.78021978, 1.        , 0.5       , 0.26666667,
       0.8372093 , 0.768     , 0.98121086, 0.96296296, 0.95833333,
       0.72727273])}in 157.8533754348755[0m
Epoch 4 with loss: 0.3054862749292737, training auc: 0.8054480377373366, training auc_pr: 0.8995773947014654, best validation AUC: 0.8323163368263273, weight_norm: 258.06103515625 in 1299.4305424690247
[95m Eval Performance:{'auc': 0.824119929443277, 'microf1': 0.9041822721598003, 'k': 0.886330041180208}in 151.81886434555054[0m
[93m Test Performance:{'auc': 0.8088480395152463, 'microf1': 0.9026523334808298, 'k': 0.8844575395924626}in 151.81978821754456[0m
Epoch 5 with loss: 0.2937621474549884, training auc: 0.8081594629812605, training auc_pr: 0.902986460290699, best validation AUC: 0.8323163368263273, weight_norm: 266.7894287109375 in 1298.7698771953583
[95m Eval Performance:{'auc': 0.8012853622173933, 'microf1': 0.9041822721598003, 'k': 0.8863101148744806}in 154.66654896736145[0m
[93m Test Performance:{'auc': 0.8106838326966369, 'microf1': 0.9038236289336005, 'k': 0.8858390422696456}in 154.6673228740692[0m
Epoch 6 with loss: 0.2835491844585964, training auc: 0.8304997560978987, training auc_pr: 0.9046724251899496, best validation AUC: 0.8323163368263273, weight_norm: 273.8847351074219 in 1286.1046810150146
[95m Eval Performance:{'auc': 0.8210262950723555, 'microf1': 0.9064190595089472, 'k': 0.8891344452070963}in 159.60087990760803[0m
[93m Test Performance:{'auc': 0.8383507377763721, 'microf1': 0.9046305213566205, 'k': 0.8868853700974642}in 159.601735830307[0m
Epoch 7 with loss: 0.28080851742199486, training auc: 0.8312682344488117, training auc_pr: 0.9053928595301579, best validation AUC: 0.8323163368263273, weight_norm: 279.68426513671875 in 1311.597782611847
[95m Eval Performance:{'auc': 0.8262889238270503, 'microf1': 0.8995006242197253, 'k': 0.8806074689805716}in 150.89876008033752[0m
[93m Test Performance:{'auc': 0.8309874782907324, 'microf1': 0.90103854863479, 'k': 0.8823661822272761}in 150.8994357585907[0m
Epoch 8 with loss: 0.2718808175268627, training auc: 0.8344116300127387, training auc_pr: 0.9104804628604957, best validation AUC: 0.8323163368263273, weight_norm: 282.70849609375 in 1305.9322926998138
[95m Eval Performance:{'auc': 0.8422516390786445, 'microf1': 0.90506658343737, 'k': 0.8872124161821915}in 153.98505544662476[0m
[93m Test Performance:{'auc': 0.8015578534810366, 'microf1': 0.9031989380254561, 'k': 0.8849273454025267}in 153.9859802722931[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.66666667, 0.93233083, 0.99019608, 0.84165478, 0.90756303,
       0.92823713, 0.66666667, 0.76106195, 0.92654028, 0.92490119,
       0.55445545, 0.91954023, 0.94117647, 0.96503497, 0.8974359 ,
       0.97642164, 0.9375    , 0.82758621, 0.66666667, 0.90931373,
       0.92857143, 0.94117647, 0.90909091, 1.        , 0.92086331,
       0.        , 0.96569921, 0.        , 0.95454545, 0.79816514,
       0.66666667, 0.97799511, 0.6918239 , 0.94214876, 0.75      ,
       0.71428571, 0.92332526, 0.5       , 1.        , 0.98333333,
       0.        , 0.        , 0.4       , 0.66666667, 0.90909091,
       1.        , 0.89463135, 0.7       , 0.93883252, 0.88888889,
       1.        , 0.66666667, 0.71428571, 0.86653772, 0.87804878,
       0.46153846, 0.90839695, 0.96470588, 1.        , 0.88625304,
       0.96      , 0.        , 0.6       , 0.73333333, 0.83333333,
       0.96      , 0.95454545, 0.85436893, 0.93103448, 0.90003343,
       0.91666667, 0.96368715, 0.84861538, 0.99408284, 0.82843137,
       0.96      , 0.75862069, 1.        , 0.57142857, 0.52631579,
       0.92682927, 0.752     , 0.98136646, 1.        , 0.8372093 ,
       0.88888889])}in 154.14222598075867[0m
Epoch 9 with loss: 0.270148193467231, training auc: 0.8470503376016337, training auc_pr: 0.9093366805059379, best validation AUC: 0.8422516390786445, weight_norm: 288.27838134765625 in 1299.1044487953186
[95m Eval Performance:{'auc': 0.830624126206218, 'microf1': 0.9075114440282981, 'k': 0.8903345438115192}in 150.2843689918518[0m
[93m Test Performance:{'auc': 0.8307850289322588, 'microf1': 0.9053853562039615, 'k': 0.8877149641289024}in 150.28522539138794[0m
Epoch 10 with loss: 0.26433052349658237, training auc: 0.841227914798722, training auc_pr: 0.9106512874978647, best validation AUC: 0.8422516390786445, weight_norm: 290.3607177734375 in 1295.3396797180176
[95m Eval Performance:{'auc': 0.8602180338986474, 'microf1': 0.9064710778193924, 'k': 0.8889681698642623}in 137.2975890636444[0m
[93m Test Performance:{'auc': 0.807804587128115, 'microf1': 0.9067128243837684, 'k': 0.889138594145723}in 137.2981414794922[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([0.        , 0.97674419, 0.99512195, 0.84633796, 0.92173913,
       0.93161706, 0.85714286, 0.76635514, 0.92619048, 0.93536122,
       0.58730159, 0.91111111, 0.875     , 0.93706294, 0.89411765,
       0.97919556, 0.88235294, 0.75      , 0.70588235, 0.90909091,
       0.92485549, 1.        , 0.66666667, 0.98591549, 0.92631579,
       0.        , 0.97560976, 0.5       , 0.9516129 , 0.84166667,
       0.        , 0.97810219, 0.64739884, 0.96666667, 0.76923077,
       0.94444444, 0.93487222, 0.8       , 1.        , 0.97435897,
       0.        , 0.        , 0.        , 1.        , 1.        ,
       0.90909091, 0.8942633 , 0.83333333, 0.94181759, 0.88888889,
       1.        , 0.66666667, 0.85245902, 0.88976378, 0.77272727,
       0.4       , 0.8778626 , 0.96912114, 1.        , 0.91262136,
       0.95049505, 0.5       , 0.72727273, 0.77894737, 0.92307692,
       0.97959184, 0.94712644, 0.7032967 , 0.91743119, 0.90992167,
       0.88727273, 0.96522949, 0.84440248, 0.98823529, 0.8394471 ,
       0.97272727, 0.80628272, 1.        , 0.57142857, 0.66666667,
       0.83333333, 0.77777778, 0.9789916 , 1.        , 0.90909091,
       0.90909091])}in 137.45973706245422[0m
Epoch 11 with loss: 0.2606799502032144, training auc: 0.8455065035572432, training auc_pr: 0.9125823486159491, best validation AUC: 0.8602180338986474, weight_norm: 293.61676025390625 in 1300.377858877182
[95m Eval Performance:{'auc': 0.8444204159505302, 'microf1': 0.9075634623387431, 'k': 0.8902387385532935}in 169.32125520706177[0m
[93m Test Performance:{'auc': 0.8546922232268246, 'microf1': 0.9073375152919129, 'k': 0.8899321061778126}in 169.32210755348206[0m
Epoch 12 with loss: 0.25703167112100694, training auc: 0.8484846546451337, training auc_pr: 0.9128645806255152, best validation AUC: 0.8602180338986474, weight_norm: 295.5025329589844 in 1314.3887865543365
[95m Eval Performance:{'auc': 0.8233437473813309, 'microf1': 0.9088639200998752, 'k': 0.8917370818702967}in 157.81457686424255[0m
[93m Test Performance:{'auc': 0.8099489350070638, 'microf1': 0.9068689971108046, 'k': 0.8892801929158655}in 157.81534671783447[0m
Epoch 13 with loss: 0.25642199147315253, training auc: 0.8455136499137068, training auc_pr: 0.9136667137053349, best validation AUC: 0.8602180338986474, weight_norm: 298.3383483886719 in 1341.3787791728973
[95m Eval Performance:{'auc': 0.8365796850899878, 'microf1': 0.9096441947565544, 'k': 0.8928810262412051}in 160.25767183303833[0m
[93m Test Performance:{'auc': 0.8157131239072266, 'microf1': 0.9057237304458732, 'k': 0.888213331778081}in 160.2583498954773[0m
Epoch 14 with loss: 0.25519614932082946, training auc: 0.8502065045064682, training auc_pr: 0.9133250644305969, best validation AUC: 0.8602180338986474, weight_norm: 299.9021301269531 in 1318.3235819339752
[95m Eval Performance:{'auc': 0.8455512180806186, 'microf1': 0.903766125676238, 'k': 0.8857303105007086}in 156.6590735912323[0m
[93m Test Performance:{'auc': 0.829442440902255, 'microf1': 0.9073895728675916, 'k': 0.8900269513805266}in 156.65973448753357[0m
Epoch 15 with loss: 0.2503987558115096, training auc: 0.8592238548685959, training auc_pr: 0.915516076083808, best validation AUC: 0.8602180338986474, weight_norm: 301.7197265625 in 1297.1852793693542
[95m Eval Performance:{'auc': 0.8098172103370712, 'microf1': 0.9073033707865169, 'k': 0.8900013619637884}in 160.43729329109192[0m
[93m Test Performance:{'auc': 0.8567264035552606, 'microf1': 0.9084307243811656, 'k': 0.8912330935153273}in 160.4380202293396[0m
Epoch 16 with loss: 0.25370182230359034, training auc: 0.8523513490468736, training auc_pr: 0.9141420518267096, best validation AUC: 0.8602180338986474, weight_norm: 303.9026184082031 in 1312.9906647205353
[95m Eval Performance:{'auc': 0.8149791163049841, 'microf1': 0.9075114440282981, 'k': 0.8902665066321169}in 158.6247627735138[0m
[93m Test Performance:{'auc': 0.8284114283730024, 'microf1': 0.9073375152919129, 'k': 0.889986531261672}in 158.62551927566528[0m
Epoch 17 with loss: 0.24791258139269692, training auc: 0.8593219900081042, training auc_pr: 0.9168306830757349, best validation AUC: 0.8602180338986474, weight_norm: 304.66748046875 in 1307.412968635559
[95m Eval Performance:{'auc': 0.8190131231226102, 'microf1': 0.911100707449022, 'k': 0.8944891883216611}in 157.90345454216003[0m
[93m Test Performance:{'auc': 0.841864877129851, 'microf1': 0.9075197168067883, 'k': 0.8901806980679237}in 157.90414214134216[0m
Epoch 18 with loss: 0.2482982787489891, training auc: 0.8662237749275954, training auc_pr: 0.9156943278793236, best validation AUC: 0.8602180338986474, weight_norm: 306.309814453125 in 1302.145695924759
[95m Eval Performance:{'auc': 0.8374413005349074, 'microf1': 0.9109966708281315, 'k': 0.8945073579340593}in 158.01954746246338[0m
[93m Test Performance:{'auc': 0.831761291519427, 'microf1': 0.908691012259559, 'k': 0.8916408884020309}in 158.02029514312744[0m
Epoch 19 with loss: 0.24321455478668214, training auc: 0.8617608378625252, training auc_pr: 0.9178407765836558, best validation AUC: 0.8602180338986474, weight_norm: 307.40521240234375 in 1317.0767295360565
[95m Eval Performance:{'auc': 0.825458514074316, 'microf1': 0.9109966708281315, 'k': 0.8942910299749178}in 153.26086497306824[0m
[93m Test Performance:{'auc': 0.8149005347339215, 'microf1': 0.9069991410500013, 'k': 0.8893805222838547}in 153.26158380508423[0m
Epoch 20 with loss: 0.24318239859172275, training auc: 0.8578617240382557, training auc_pr: 0.9167712658105628, best validation AUC: 0.8602180338986474, weight_norm: 308.09649658203125 in 1301.0988523960114
[95m Eval Performance:{'auc': 0.8118599602293017, 'microf1': 0.9099042863087807, 'k': 0.8928571007946698}in 152.4057948589325[0m
[93m Test Performance:{'auc': 0.8072025803768053, 'microf1': 0.907571774382467, 'k': 0.8900173550984155}in 152.4065854549408[0m
Epoch 21 with loss: 0.2437452226309549, training auc: 0.8694638223675859, training auc_pr: 0.9183755319702023, best validation AUC: 0.8602180338986474, weight_norm: 310.0035400390625 in 1291.4528126716614
[95m Eval Performance:{'auc': 0.849707634511247, 'microf1': 0.9080316271327508, 'k': 0.8910061277472271}in 156.38797855377197[0m
[93m Test Performance:{'auc': 0.8565768131670882, 'microf1': 0.9091595304406673, 'k': 0.892330051004676}in 156.3886866569519[0m
Epoch 22 with loss: 0.24092178032511757, training auc: 0.8567945371774929, training auc_pr: 0.918108154276929, best validation AUC: 0.8602180338986474, weight_norm: 311.25250244140625 in 1307.2274954319
[95m Eval Performance:{'auc': 0.8480203788084977, 'microf1': 0.9119330004161464, 'k': 0.8953553467683215}in 155.5073525905609[0m
[93m Test Performance:{'auc': 0.8136176914278146, 'microf1': 0.9088732137744345, 'k': 0.8916285947201705}in 155.50816893577576[0m
Epoch 23 with loss: 0.23771407496361505, training auc: 0.8607521668281357, training auc_pr: 0.91964557601325, best validation AUC: 0.8602180338986474, weight_norm: 311.9048156738281 in 1311.3323686122894
[95m Eval Performance:{'auc': 0.8151728330635883, 'microf1': 0.9096962130669995, 'k': 0.8927325255451783}in 258.5384907722473[0m
[93m Test Performance:{'auc': 0.8390885275750776, 'microf1': 0.9079361774122179, 'k': 0.8905690839633472}in 258.53919529914856[0m
Epoch 24 with loss: 0.23634259791601273, training auc: 0.8699893589119833, training auc_pr: 0.919318781054805, best validation AUC: 0.8602180338986474, weight_norm: 312.77154541015625 in 1422.895277261734
[95m Eval Performance:{'auc': 0.81288261974098, 'microf1': 0.9081876820640865, 'k': 0.8913418018493102}in 157.51749277114868[0m
[93m Test Performance:{'auc': 0.8336241090670686, 'microf1': 0.9068429683229652, 'k': 0.8896419274018266}in 157.5181131362915[0m
Epoch 25 with loss: 0.2402722136179606, training auc: 0.8591970439609012, training auc_pr: 0.918821161458991, best validation AUC: 0.8602180338986474, weight_norm: 314.00665283203125 in 1321.2539582252502
[95m Eval Performance:{'auc': 0.8300005312781729, 'microf1': 0.9094881398252185, 'k': 0.8925976880402815}in 160.68476104736328[0m
[93m Test Performance:{'auc': 0.8369161088410833, 'microf1': 0.9085608683203623, 'k': 0.8913507364567568}in 160.68550777435303[0m
Epoch 26 with loss: 0.23476763325078145, training auc: 0.8747606045681731, training auc_pr: 0.9195861587480783, best validation AUC: 0.8602180338986474, weight_norm: 315.1030578613281 in 1300.4077334403992
[95m Eval Performance:{'auc': 0.8492281113954147, 'microf1': 0.9098522679983354, 'k': 0.8931553954431204}in 160.05255246162415[0m
[93m Test Performance:{'auc': 0.8315759721456853, 'microf1': 0.9081444077149328, 'k': 0.8910092038000752}in 160.05328512191772[0m
Epoch 27 with loss: 0.23432918104387465, training auc: 0.863655089296478, training auc_pr: 0.9194598970595882, best validation AUC: 0.8602180338986474, weight_norm: 316.2239685058594 in 1303.2543597221375
[95m Eval Performance:{'auc': 0.8571333978264792, 'microf1': 0.9104764877236787, 'k': 0.8938655484586824}in 154.06980752944946[0m
[93m Test Performance:{'auc': 0.8313847674685112, 'microf1': 0.9088992425622738, 'k': 0.8919634847995584}in 154.070636510849[0m
Epoch 28 with loss: 0.23312054449603672, training auc: 0.8741083336669005, training auc_pr: 0.9205591164652669, best validation AUC: 0.8602180338986474, weight_norm: 317.27789306640625 in 1298.1135907173157
[95m Eval Performance:{'auc': 0.8400827338709201, 'microf1': 0.9100083229296713, 'k': 0.8931552525002098}in 155.97797870635986[0m
[93m Test Performance:{'auc': 0.8519028107605766, 'microf1': 0.9076758895338244, 'k': 0.890296103986594}in 155.9787232875824[0m
Epoch 29 with loss: 0.23007759082885015, training auc: 0.8689583487443575, training auc_pr: 0.9211012990099599, best validation AUC: 0.8602180338986474, weight_norm: 317.2021179199219 in 1300.9282953739166
[95m Eval Performance:{'auc': 0.8561736397400963, 'microf1': 0.9084997919267582, 'k': 0.8916348369988429}in 155.3076205253601[0m
[93m Test Performance:{'auc': 0.8417015846302284, 'microf1': 0.9056977016580338, 'k': 0.8882252797078478}in 155.30834317207336[0m
Epoch 30 with loss: 0.2293296228136335, training auc: 0.8692145135360281, training auc_pr: 0.9212275606984499, best validation AUC: 0.8602180338986474, weight_norm: 318.3828125 in 1294.1561872959137
[95m Eval Performance:{'auc': 0.8347130154926264, 'microf1': 0.909019975031211, 'k': 0.8921521153947143}in 152.7538890838623[0m
[93m Test Performance:{'auc': 0.8531239592007532, 'microf1': 0.9077279471095031, 'k': 0.8905041930180221}in 152.7547845840454[0m
Epoch 31 with loss: 0.22436496208111445, training auc: 0.8757516262706786, training auc_pr: 0.9235151254075653, best validation AUC: 0.8602180338986474, weight_norm: 318.15191650390625 in 1296.1934051513672
[95m Eval Performance:{'auc': 0.8294429696029492, 'microf1': 0.9102163961714523, 'k': 0.893548498805722}in 156.66842985153198[0m
[93m Test Performance:{'auc': 0.8401918222379625, 'microf1': 0.9085088107446836, 'k': 0.8914253553431961}in 156.6691541671753[0m
Epoch 32 with loss: 0.22809805035591124, training auc: 0.8655151062715921, training auc_pr: 0.9218662962990471, best validation AUC: 0.8602180338986474, weight_norm: 320.71917724609375 in 1313.9878919124603
[95m Eval Performance:{'auc': 0.8372706210049492, 'microf1': 0.9091760299625468, 'k': 0.8923244126018972}in 157.0922815799713[0m
[93m Test Performance:{'auc': 0.840721340938443, 'microf1': 0.9079361774122179, 'k': 0.8908270202434432}in 157.09299302101135[0m
Epoch 33 with loss: 0.2293728183280854, training auc: 0.869848451647422, training auc_pr: 0.9218440148246076, best validation AUC: 0.8602180338986474, weight_norm: 320.89361572265625 in 1303.7889494895935
[95m Eval Performance:{'auc': 0.8445588297297671, 'microf1': 0.9095401581356637, 'k': 0.892535484299334}in 160.01622891426086[0m
[93m Test Performance:{'auc': 0.8359426941673194, 'microf1': 0.9082485228662901, 'k': 0.8909523114409452}in 160.01697397232056[0m
Epoch 34 with loss: 0.22714063245625724, training auc: 0.8556815395218494, training auc_pr: 0.9225495948485231, best validation AUC: 0.8602180338986474, weight_norm: 321.92938232421875 in 1301.7727646827698
[95m Eval Performance:{'auc': 0.8321621298041405, 'microf1': 0.9125052018310446, 'k': 0.8960476031387091}in 155.0924050807953[0m
[93m Test Performance:{'auc': 0.8214741910177812, 'microf1': 0.9096801061974544, 'k': 0.8926049603733693}in 155.09310126304626[0m
Epoch 35 with loss: 0.224088716847556, training auc: 0.8744484699749033, training auc_pr: 0.9233071649794639, best validation AUC: 0.8602180338986474, weight_norm: 321.4986572265625 in 1299.8045105934143
[95m Eval Performance:{'auc': 0.8383997531086669, 'microf1': 0.9109446525176862, 'k': 0.8944730865327002}in 156.8229112625122[0m
[93m Test Performance:{'auc': 0.8284138273003838, 'microf1': 0.9100705380150447, 'k': 0.8933571333305264}in 156.82372784614563[0m
Epoch 36 with loss: 0.22471340134030296, training auc: 0.8771312879227336, training auc_pr: 0.9224010516855935, best validation AUC: 0.8602180338986474, weight_norm: 322.66668701171875 in 1299.0063235759735
[95m Eval Performance:{'auc': 0.8794160035421905, 'microf1': 0.9091760299625468, 'k': 0.89237241137613}in 156.86591029167175[0m
[93m Test Performance:{'auc': 0.8312821780842307, 'microf1': 0.90905541528931, 'k': 0.8921480004946172}in 156.86671447753906[0m
Better models found w.r.t accuracy. Saved it!
[93m Test Performance Per Class:{'f1': array([1.        , 0.95384615, 0.99029126, 0.84997588, 0.93103448,
       0.9281768 , 0.4       , 0.81904762, 0.92848485, 0.93129771,
       0.50847458, 0.91304348, 0.94117647, 0.96551724, 0.86486486,
       0.98289413, 0.9375    , 0.82758621, 0.70588235, 0.90457413,
       0.91358025, 1.        , 0.95238095, 0.96      , 0.91289199,
       0.        , 0.97587131, 0.        , 0.984375  , 0.81102362,
       0.        , 0.98019802, 0.6119403 , 0.94214876, 0.92307692,
       0.8372093 , 0.93831169, 0.90909091, 0.98245614, 0.98360656,
       0.        , 1.        , 0.        , 1.        , 1.        ,
       0.57142857, 0.89689082, 0.76923077, 0.94710744, 0.90909091,
       0.96774194, 1.        , 0.83870968, 0.86549708, 0.93023256,
       0.5       , 0.89285714, 0.96172249, 1.        , 0.91067792,
       0.96410256, 0.8       , 0.76923077, 0.83809524, 0.75      ,
       0.97959184, 0.94063927, 0.82352941, 0.90265487, 0.89760766,
       0.91512915, 0.95480226, 0.8455813 , 1.        , 0.84927152,
       0.95495495, 0.81218274, 1.        , 0.72727273, 0.47619048,
       0.84210526, 0.79032258, 0.96919918, 1.        , 0.93589744,
       0.88888889])}in 156.9910752773285[0m
Epoch 37 with loss: 0.22214932952608382, training auc: 0.8750912632622938, training auc_pr: 0.9235076982494188, best validation AUC: 0.8794160035421905, weight_norm: 322.75177001953125 in 1301.8508746623993
[95m Eval Performance:{'auc': 0.8371844009927185, 'microf1': 0.9092800665834374, 'k': 0.8923721680784216}in 156.60868954658508[0m
[93m Test Performance:{'auc': 0.8560273627882172, 'microf1': 0.908612925896041, 'k': 0.8915089292271902}in 156.60944390296936[0m
Epoch 38 with loss: 0.22591428810641878, training auc: 0.8816625691308286, training auc_pr: 0.9220222666201231, best validation AUC: 0.8794160035421905, weight_norm: 322.9983825683594 in 1308.059945821762
[95m Eval Performance:{'auc': 0.8654428145728135, 'microf1': 0.9098522679983354, 'k': 0.8930853143434263}in 155.22856903076172[0m
[93m Test Performance:{'auc': 0.871404270537623, 'microf1': 0.9102267107420807, 'k': 0.8934481228936954}in 155.22928023338318[0m
Epoch 39 with loss: 0.21911202013492584, training auc: 0.8740172674844278, training auc_pr: 0.9252307989394019, best validation AUC: 0.8794160035421905, weight_norm: 323.9346923828125 in 1300.9501557350159
[95m Eval Performance:{'auc': 0.8393179185840074, 'microf1': 0.91167290886392, 'k': 0.8953340155926587}in 158.44440484046936[0m
[93m Test Performance:{'auc': 0.8652557862126077, 'microf1': 0.9110075743772612, 'k': 0.8945136244716168}in 158.44520807266235[0m
Epoch 40 with loss: 0.2200901736531939, training auc: 0.8777771212730464, training auc_pr: 0.924443520175875, best validation AUC: 0.8794160035421905, weight_norm: 325.1120300292969 in 1310.1425132751465
[95m Eval Performance:{'auc': 0.827183408107357, 'microf1': 0.9082917186849772, 'k': 0.8912346320100255}in 152.42546439170837[0m
[93m Test Performance:{'auc': 0.8450183946958124, 'microf1': 0.9065826804445717, 'k': 0.8891368333654965}in 152.42630743980408[0m
Epoch 41 with loss: 0.21918960845186597, training auc: 0.880004916369317, training auc_pr: 0.9247851694506131, best validation AUC: 0.8794160035421905, weight_norm: 326.00030517578125 in 1296.9602046012878
[95m Eval Performance:{'auc': 0.8504854872659894, 'microf1': 0.9071993341656261, 'k': 0.8900279787589882}in 158.0615530014038[0m
[93m Test Performance:{'auc': 0.850593224962244, 'microf1': 0.9088732137744345, 'k': 0.8919232775576865}in 158.06226539611816[0m
Epoch 42 with loss: 0.2193930207831519, training auc: 0.8733642494148727, training auc_pr: 0.9243841029107033, best validation AUC: 0.8794160035421905, weight_norm: 326.8607482910156 in 1311.3221151828766
[95m Eval Performance:{'auc': 0.8238220314774455, 'microf1': 0.9119330004161464, 'k': 0.8956024127353088}in 154.1680884361267[0m
[93m Test Performance:{'auc': 0.8440376741253932, 'microf1': 0.9105650849839922, 'k': 0.8939179113508577}in 154.1688995361328[0m
Epoch 43 with loss: 0.2198016017533484, training auc: 0.8808909514476871, training auc_pr: 0.9242429869059202, best validation AUC: 0.8794160035421905, weight_norm: 326.5139465332031 in 1295.248568058014
[95m Eval Performance:{'auc': 0.8593121792584292, 'microf1': 0.9097482313774449, 'k': 0.8929373670995373}in 153.336172580719[0m
[93m Test Performance:{'auc': 0.8384693264351111, 'microf1': 0.910174653166402, 'k': 0.8933647116520091}in 153.33689260482788[0m
Epoch 44 with loss: 0.21794953156085242, training auc: 0.8794195585137431, training auc_pr: 0.9246514806039765, best validation AUC: 0.8794160035421905, weight_norm: 329.1211242675781 in 1293.8558101654053
[95m Eval Performance:{'auc': 0.8680611432793435, 'microf1': 0.9112567623803579, 'k': 0.894713376580768}in 150.95908379554749[0m
[93m Test Performance:{'auc': 0.8438084024384537, 'microf1': 0.9100705380150447, 'k': 0.893255175553197}in 150.95971870422363[0m
Epoch 45 with loss: 0.21754793804316294, training auc: 0.8663816517737888, training auc_pr: 0.925312497679013, best validation AUC: 0.8794160035421905, weight_norm: 329.8879089355469 in 1289.983802318573
[95m Eval Performance:{'auc': 0.8231892314892192, 'microf1': 0.911100707449022, 'k': 0.8943711347199231}in 155.89669251441956[0m
[93m Test Performance:{'auc': 0.8068559722198179, 'microf1': 0.908612925896041, 'k': 0.8913402962282706}in 155.89737629890442[0m
Epoch 46 with loss: 0.2155103378068833, training auc: 0.8718141148635816, training auc_pr: 0.9261814751821511, best validation AUC: 0.8794160035421905, weight_norm: 330.52410888671875 in 1299.8228278160095
[95m Eval Performance:{'auc': 0.8402018630598123, 'microf1': 0.9085518102372035, 'k': 0.8914521849954321}in 153.0281949043274[0m
[93m Test Performance:{'auc': 0.8413773046896506, 'microf1': 0.908691012259559, 'k': 0.891620929726421}in 153.02883863449097[0m
Epoch 47 with loss: 0.2140201808441253, training auc: 0.8804838199717908, training auc_pr: 0.9260997764425398, best validation AUC: 0.8794160035421905, weight_norm: 330.3223876953125 in 1299.6856865882874
[95m Eval Performance:{'auc': 0.8545649985268038, 'microf1': 0.9104244694132334, 'k': 0.8938850576092127}in 153.00426697731018[0m
[93m Test Performance:{'auc': 0.8582636904140213, 'microf1': 0.9098362789244905, 'k': 0.8931418530741647}in 153.00487971305847[0m
Epoch 48 with loss: 0.21493755278133211, training auc: 0.8711112188596463, training auc_pr: 0.925513030948968, best validation AUC: 0.8794160035421905, weight_norm: 330.5951232910156 in 1300.1785581111908
[95m Eval Performance:{'auc': 0.8400789360490567, 'microf1': 0.9110486891385767, 'k': 0.8946260792235068}in 154.22001099586487[0m
[93m Test Performance:{'auc': 0.8539849916627122, 'microf1': 0.9114500637705302, 'k': 0.895037340641483}in 154.22069001197815[0m
Epoch 49 with loss: 0.21343462606271107, training auc: 0.8855754545065322, training auc_pr: 0.9264191442428383, best validation AUC: 0.8794160035421905, weight_norm: 331.78228759765625 in 1295.8607904911041
[95m Eval Performance:{'auc': 0.8485561277641986, 'microf1': 0.9113087806908031, 'k': 0.8945701944718737}in 159.50380635261536[0m
[93m Test Performance:{'auc': 0.8336173631011812, 'microf1': 0.910096566802884, 'k': 0.8931351629470567}in 159.5046422481537[0m
Epoch 50 with loss: 0.21245550388381595, training auc: 0.8800201053699006, training auc_pr: 0.9267088034105511, best validation AUC: 0.8794160035421905, weight_norm: 331.9642333984375 in 1297.125571012497
